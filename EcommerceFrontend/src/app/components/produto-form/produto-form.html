<div class="produto-form-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <mat-icon>{{ isEditMode ? 'edit' : 'add' }}</mat-icon>
        {{ isEditMode ? 'Editar Produto' : 'Novo Produto' }}
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="produtoForm" (ngSubmit)="onSubmit()" class="form">
        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Código</mat-label>
            <input matInput formControlName="codigo" placeholder="Digite o código do produto">
            <mat-error *ngIf="produtoForm.get('codigo')?.hasError('required')">
              {{ getErrorMessage('codigo') }}
            </mat-error>
            <mat-error *ngIf="produtoForm.get('codigo')?.hasError('maxlength')">
              {{ getErrorMessage('codigo') }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Descrição</mat-label>
            <input matInput formControlName="descricao" placeholder="Digite a descrição do produto">
            <mat-error *ngIf="produtoForm.get('descricao')?.hasError('required')">
              {{ getErrorMessage('descricao') }}
            </mat-error>
            <mat-error *ngIf="produtoForm.get('descricao')?.hasError('maxlength')">
              {{ getErrorMessage('descricao') }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Departamento</mat-label>
            <mat-select formControlName="departamentoCodigo">
              <mat-option *ngFor="let dept of departamentos" [value]="dept.codigo">
                {{ dept.codigo }} - {{ dept.descricao }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="produtoForm.get('departamentoCodigo')?.hasError('required')">
              {{ getErrorMessage('departamentoCodigo') }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Preço</mat-label>
            <input matInput type="number" formControlName="preco" placeholder="0,00" step="0.01" min="0">
            <span matPrefix>R$&nbsp;</span>
            <mat-error *ngIf="produtoForm.get('preco')?.hasError('required')">
              {{ getErrorMessage('preco') }}
            </mat-error>
            <mat-error *ngIf="produtoForm.get('preco')?.hasError('min')">
              {{ getErrorMessage('preco') }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-slide-toggle formControlName="status" color="primary">
            Produto Ativo
          </mat-slide-toggle>
        </div>

        <div class="form-actions">
          <button type="button" mat-button (click)="cancelar()">
            <mat-icon>cancel</mat-icon>
            Cancelar
          </button>
          <button type="submit" mat-raised-button color="primary" [disabled]="loading || produtoForm.invalid">
            <mat-icon>{{ isEditMode ? 'save' : 'add' }}</mat-icon>
            {{ isEditMode ? 'Atualizar' : 'Criar' }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
